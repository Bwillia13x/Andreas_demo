
> rest-express@1.0.0 test:performance
> npm run build && tsx scripts/performance-tests.ts


> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.19 building for production...
transforming...
✓ 3354 modules transformed.
rendering chunks...
computing gzip size...
../dist/public/index.html                       2.42 kB │ gzip:   0.92 kB
../dist/public/assets/index-B52fWKlG.css       70.33 kB │ gzip:  12.42 kB
../dist/public/assets/input-DTh9FO78.js         0.62 kB │ gzip:   0.37 kB
../dist/public/assets/not-found-DHsg-N0R.js     0.72 kB │ gzip:   0.41 kB
../dist/public/assets/card-CCpIX1gV.js          1.03 kB │ gzip:   0.39 kB
../dist/public/assets/select-DbUZ0Jw7.js        3.11 kB │ gzip:   1.14 kB
../dist/public/assets/chart-DLmIzyqq.js         4.59 kB │ gzip:   1.94 kB
../dist/public/assets/home-RDarpIEi.js          5.97 kB │ gzip:   2.06 kB
../dist/public/assets/scheduling-CmD-jkTR.js    8.69 kB │ gzip:   2.41 kB
../dist/public/assets/marketing-s5EdLQ0x.js     8.94 kB │ gzip:   2.78 kB
../dist/public/assets/staff-DBDinTXc.js         9.13 kB │ gzip:   2.24 kB
../dist/public/assets/inventory-BdwTlebz.js     9.29 kB │ gzip:   2.52 kB
../dist/public/assets/loyalty-D2cSzbZT.js       9.59 kB │ gzip:   2.87 kB
../dist/public/assets/pos-mZNjMqXd.js          14.40 kB │ gzip:   4.04 kB
../dist/public/assets/icons-CUuMniuQ.js        15.81 kB │ gzip:   3.25 kB
../dist/public/assets/analytics-BVIYQDfh.js    17.74 kB │ gzip:   4.14 kB
../dist/public/assets/index-C0RAkEYh.js        32.81 kB │ gzip:   9.63 kB
../dist/public/assets/query-CyeIJ-bU.js        36.17 kB │ gzip:  10.92 kB
../dist/public/assets/charts-f_bXvggi.js      241.78 kB │ gzip:  56.48 kB
../dist/public/assets/vendor-DvMHagaH.js      458.15 kB │ gzip: 151.33 kB
✓ built in 3.34s
🚀 Performance Testing Suite
============================

📋 Test Configuration:
  • Max concurrent users: 50
  • Ramp-up duration: 30s
  • Sustained duration: 60s
  • Memory threshold: 100MB
  • Response time endpoints: 10
  • Output directory: test-results

🚀 Starting performance test suite...
✅ Test server started on http://127.0.0.1:60054

📊 Executing load tests...
✅ Using service "Executive Cut" (231b040b-6164-4a57-a72b-a39b9aee33e5) for load testing
🚀 Starting load test...
Target: 50 concurrent users
Ramp-up: 30000ms
Sustained: 60000ms
📈 Ramp-up phase starting...
  Active users: 5/50
  Active users: 10/50
  Active users: 15/50
  Active users: 20/50
  Active users: 25/50
  Active users: 30/50
  Active users: 35/50
  Active users: 40/50
  Active users: 45/50
  Active users: 50/50
✅ Ramp-up complete: 50 active users
⏱️  Sustained load phase starting...
  Progress: 15% | RPS: 131 | Avg RT: 1ms | Errors: 100.0%
  Progress: 32% | RPS: 81 | Avg RT: 1ms | Errors: 100.0%
  Progress: 48% | RPS: 19 | Avg RT: 1ms | Errors: 100.0%
  Progress: 65% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 82% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 98% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
✅ Sustained load phase complete
📉 Ramp-down phase starting...
  Active users: 40
  Active users: 30
  Active users: 20
  Active users: 10
  Active users: 0
✅ Ramp-down complete
✅ Using service "Executive Cut" (231b040b-6164-4a57-a72b-a39b9aee33e5) for load testing
🚀 Starting concurrent test with 100 users for 30000ms
  Progress: 30% | RPS: 331 | Avg RT: 1ms | Errors: 100.0%
  Progress: 63% | RPS: 330 | Avg RT: 1ms | Errors: 100.0%
  Progress: 97% | RPS: 290 | Avg RT: 1ms | Errors: 100.0%
✅ Spike test completed: 9868 requests, 2ms avg response time
🚀 Starting concurrent test with 25 users for 120000ms
  Progress: 8% | RPS: 80 | Avg RT: 1ms | Errors: 100.0%
  Progress: 16% | RPS: 86 | Avg RT: 1ms | Errors: 98.8%
  Progress: 24% | RPS: 69 | Avg RT: 2ms | Errors: 100.0%
  Progress: 33% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 41% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 49% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 58% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 66% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 74% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 83% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 91% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%
  Progress: 99% | RPS: 0 | Avg RT: 0ms | Errors: 0.0%

⏱️  Executing response time tests...
⏱️  Starting response time and latency tests...
  Testing GET /api/health...
    ✅ avg=1.7ms, p95=2.0ms, p99=2.0ms
  Testing GET /api/services...
    ✅ avg=1.9ms, p95=3.0ms, p99=3.0ms
  Testing GET /api/staff...
    ✅ avg=1.8ms, p95=2.0ms, p99=2.0ms
  Testing GET /api/appointments?day=today...
    ✅ avg=1.9ms, p95=3.0ms, p99=3.0ms
  Testing GET /api/customers...
    ✅ avg=2.0ms, p95=6.0ms, p99=6.0ms
  Testing GET /api/inventory...
    ✅ avg=1.9ms, p95=5.0ms, p99=5.0ms
  Testing GET /api/analytics...
    ✅ avg=1.3ms, p95=2.0ms, p99=2.0ms
  Testing GET /api/pos/sales...
    ✅ avg=1.9ms, p95=2.0ms, p99=2.0ms
  Testing GET /api/marketing/campaigns...
    ✅ avg=2.1ms, p95=8.0ms, p99=8.0ms
  Testing GET /api/loyalty/entries...
    ✅ avg=1.6ms, p95=2.0ms, p99=2.0ms
  Testing concurrent latency with 10 requests...
    ✅ 10 concurrent requests: avg=5.9ms, throughput=1250.0 RPS
  Testing page load times...
    ✅ /: 12ms (9 assets, 2.4KB)
    ✅ /pos: 3ms (9 assets, 2.4KB)
    ✅ /analytics: 1ms (9 assets, 2.4KB)
    ✅ /inventory: 1ms (9 assets, 2.4KB)
    ✅ /marketing: 1ms (9 assets, 2.4KB)
    ✅ /loyalty: 1ms (9 assets, 2.4KB)
    ✅ /scheduling: 1ms (9 assets, 2.4KB)
    ✅ /staff: 0ms (9 assets, 2.4KB)
  Testing streaming performance...
    ✅ "What is our schedule today?...": first byte=2ms, rate=218000.0 chars/s
    ✅ "Give me a quick summary of our...": first byte=1ms, rate=413000.0 chars/s
    ✅ "How are our marketing campaign...": first byte=1ms, rate=436000.0 chars/s
✅ Response time and latency tests completed

🧠 Executing memory and resource monitoring tests...
🧠 Starting memory and resource monitoring tests...
  Testing memory leak detection...
    ✅ No memory leaks detected. Peak: 24MB, Avg: 21.3MB, Stability: 96.4%
  Testing CPU usage monitoring...
    ✅ CPU usage within limits. Peak: 1.0%, Avg: 0.5%, Stability: 99.8%
  Testing resource usage monitoring...
    ✅ Resource usage within limits. Peak handles: 59, Avg event loop delay: 4.6ms
  Testing resources under simulated load...
    ✅ Resources stable under load
    Memory: peak=106MB, CPU: peak=42.1%
✅ Memory and resource monitoring tests completed
✅ Performance test suite completed

📊 Performance Test Results:
============================
Total tests: 29
Passed: 27
Failed: 2
Pass rate: 93.1%

❌ Failed Tests:
  • load-test-ramp-up: Load test failed validation: Error rate (88.1%) exceeds threshold (1%)
  • load-test-sustained: Sustained load test failed: Error rate (88.0%) exceeds threshold (1%)

📈 Performance Metrics:

⏱️  Response Time Results:

🧠 Memory Test Results:

💡 Recommendations:
  • Performance looks good! No specific recommendations at this time.

❌ Performance tests completed with failures
